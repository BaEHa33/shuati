<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼å‡ºåŒæ­¥åŠŸèƒ½å¯¹æ¯”æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        success: '#22c55e',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        info: '#0ea5e9',
                        light: '#f8fafc',
                        dark: '#1e293b'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .glass {
                background: rgba(255, 255, 255, 0.25);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }
            .btn {
                @apply px-4 py-2 rounded-lg font-medium transition-all duration-200;
            }
            .btn-primary {
                @apply bg-primary text-white hover:bg-blue-600 active:bg-blue-700;
            }
            .btn-secondary {
                @apply bg-secondary text-white hover:bg-slate-600 active:bg-slate-700;
            }
            .btn-success {
                @apply bg-success text-white hover:bg-green-600 active:bg-green-700;
            }
            .btn-danger {
                @apply bg-danger text-white hover:bg-red-600 active:bg-red-700;
            }
            .card {
                @apply bg-white rounded-xl shadow-lg p-6 border border-gray-200;
            }
            .input {
                @apply w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent;
            }
            .badge {
                @apply px-2 py-1 text-xs font-medium rounded-full;
            }
            .badge-blue {
                @apply bg-blue-100 text-blue-800;
            }
            .badge-green {
                @apply bg-green-100 text-green-800;
            }
            .badge-red {
                @apply bg-red-100 text-red-800;
            }
            .badge-yellow {
                @apply bg-yellow-100 text-yellow-800;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">ğŸ”„ å¯¼å‡ºåŒæ­¥åŠŸèƒ½å¯¹æ¯”æµ‹è¯•</h1>
            <p class="text-gray-600">æµ‹è¯•å¯¼å‡ºæ•°æ®å’ŒåŒæ­¥æ•°æ®çš„å·®å¼‚ï¼Œç¡®ä¿ä¸¤è€…éƒ½åŒ…å«é¢˜ç›®å†…å®¹</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- å¯¼å‡ºæ•°æ®æµ‹è¯• -->
            <div class="card">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-semibold text-gray-800">ğŸ“¤ å¯¼å‡ºæ•°æ®æµ‹è¯•</h2>
                    <span class="badge badge-blue">æ–‡ä»¶å¯¼å‡º</span>
                </div>
                <div class="space-y-4">
                    <button id="exportDataBtn" class="btn btn-primary w-full">
                        <i class="fa fa-download mr-2"></i>å¯¼å‡ºåŒæ­¥æ•°æ®æ–‡ä»¶
                    </button>
                    <div id="exportStatus" class="p-4 bg-gray-50 rounded-lg text-sm font-mono hidden"></div>
                </div>
            </div>

            <!-- åŒæ­¥æ•°æ®æµ‹è¯• -->
            <div class="card">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-semibold text-gray-800">ğŸ“± åŒæ­¥æ•°æ®æµ‹è¯•</h2>
                    <span class="badge badge-green">äºŒç»´ç åŒæ­¥</span>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">åŒæ­¥ç±»å‹</label>
                        <select id="syncType" class="input">
                            <option value="both">å…¨éƒ¨é¢˜ç›®</option>
                            <option value="public">ä»…å…¬å…±é¢˜åº“</option>
                            <option value="personal">ä»…ä¸ªäººé¢˜åº“</option>
                        </select>
                    </div>
                    <button id="generateSyncDataBtn" class="btn btn-success w-full">
                        <i class="fa fa-qrcode mr-2"></i>ç”ŸæˆåŒæ­¥æ•°æ®
                    </button>
                    <div id="syncStatus" class="p-4 bg-gray-50 rounded-lg text-sm font-mono hidden"></div>
                </div>
            </div>
        </div>

        <!-- æ•°æ®å¯¹æ¯”åŒº -->
        <div class="mt-8 card">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">âš–ï¸ æ•°æ®å¯¹æ¯”ç»“æœ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div id="exportResult" class="p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-semibold text-gray-700 mb-2">ğŸ“¤ å¯¼å‡ºæ•°æ®ç»“æœ</h3>
                    <div class="text-sm font-mono">ç­‰å¾…æµ‹è¯•...</div>
                </div>
                <div id="syncResult" class="p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-semibold text-gray-700 mb-2">ğŸ“± åŒæ­¥æ•°æ®ç»“æœ</h3>
                    <div class="text-sm font-mono">ç­‰å¾…æµ‹è¯•...</div>
                </div>
            </div>
        </div>

        <!-- æ“ä½œæ—¥å¿— -->
        <div class="mt-8 card">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-semibold text-gray-800">ğŸ“ æ“ä½œæ—¥å¿—</h2>
                <button id="clearLogBtn" class="btn btn-sm btn-danger">
                    <i class="fa fa-trash mr-1"></i>æ¸…ç©º
                </button>
            </div>
            <div class="bg-gray-900 text-gray-300 p-4 rounded-lg h-64 overflow-y-auto font-mono text-sm">
                <div id="logContainer"></div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿæ™ºèƒ½åˆ·é¢˜ç³»ç»Ÿçš„æ•°æ®å’Œæ–¹æ³•
        class MockExamSystem {
            constructor() {
                this.publicQuestionBank = [];
                this.personalQuestionBank = [];
                this.mistakeBank = [];
                this.studyStats = {
                    totalQuestions: 0,
                    correctAnswers: 0,
                    studyTime: 0
                };
                this.loadData();
            }

            loadData() {
                try {
                    const publicData = localStorage.getItem('publicQuestionBank');
                    const personalData = localStorage.getItem('personalQuestionBank');
                    
                    this.publicQuestionBank = publicData ? JSON.parse(publicData) : [];
                    this.personalQuestionBank = personalData ? JSON.parse(personalData) : [];
                    
                    this.log('ğŸ’¾ æ•°æ®åŠ è½½å®Œæˆ');
                    this.updateStats();
                } catch (error) {
                    this.log('âŒ æ•°æ®åŠ è½½å¤±è´¥:', error.message);
                }
            }

            saveData() {
                try {
                    localStorage.setItem('publicQuestionBank', JSON.stringify(this.publicQuestionBank));
                    localStorage.setItem('personalQuestionBank', JSON.stringify(this.personalQuestionBank));
                    this.log('ğŸ’¾ æ•°æ®ä¿å­˜å®Œæˆ');
                } catch (error) {
                    this.log('âŒ æ•°æ®ä¿å­˜å¤±è´¥:', error.message);
                }
            }

            getDeviceId() {
                let deviceId = localStorage.getItem('deviceId');
                if (!deviceId) {
                    deviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('deviceId', deviceId);
                }
                return deviceId;
            }

            // æ¨¡æ‹ŸåŸå§‹çš„å¯¼å‡ºåŒæ­¥æ•°æ®æ–¹æ³•
            async exportSyncData() {
                this.log('ğŸ“¤ å¼€å§‹å¯¼å‡ºåŒæ­¥æ•°æ®æ–‡ä»¶...');
                
                // ç”Ÿæˆä¸°å¯Œçš„æ¼”ç¤ºé¢˜ç›®
                const richDemoPublicQuestions = [
                    {
                        id: 'export_pub_1_' + Date.now(),
                        content: 'HTML5ä¸­ç”¨äºå®šä¹‰æ–‡æ¡£ä¸»è¦å†…å®¹çš„æ ‡ç­¾æ˜¯ï¼š',
                        type: 'single',
                        options: ['<header>', '<main>', '<section>', '<article>'],
                        answer: '1',
                        analysis: '<main>æ ‡ç­¾å®šä¹‰æ–‡æ¡£çš„ä¸»è¦å†…å®¹ï¼Œä¸€ä¸ªæ–‡æ¡£ä¸­åº”è¯¥åªæœ‰ä¸€ä¸ª<main>å…ƒç´ ã€‚',
                        source: 'export-demo',
                        createTime: new Date().toISOString(),
                        difficulty: 2,
                        category: 'HTML5',
                        tags: ['HTML', 'è¯­ä¹‰åŒ–æ ‡ç­¾']
                    },
                    {
                        id: 'export_pub_2_' + Date.now(),
                        content: 'CSSä¸­ï¼Œå“ªä¸ªå±æ€§ç”¨äºè®¾ç½®å…ƒç´ çš„å¤–è¾¹è·ï¼Ÿ',
                        type: 'single',
                        options: ['padding', 'border', 'margin', 'spacing'],
                        answer: '2',
                        analysis: 'marginå±æ€§ç”¨äºè®¾ç½®å…ƒç´ çš„å¤–è¾¹è·ï¼Œæ§åˆ¶å…ƒç´ ä¸å…¶ä»–å…ƒç´ ä¹‹é—´çš„è·ç¦»ã€‚',
                        source: 'export-demo',
                        createTime: new Date().toISOString(),
                        difficulty: 1,
                        category: 'CSSåŸºç¡€',
                        tags: ['CSS', 'ç›’æ¨¡å‹']
                    }
                ];
                
                const richDemoPersonalQuestions = [
                    {
                        id: 'export_per_1_' + Date.now(),
                        content: 'Vueç»„ä»¶çš„dataé€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚',
                        type: 'judge',
                        answer: 'true',
                        analysis: 'åœ¨Vueç»„ä»¶ä¸­ï¼Œdataé€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·æ¯ä¸ªå®ä¾‹å¯ä»¥ç»´æŠ¤ç‹¬ç«‹çš„æ•°æ®å‰¯æœ¬ï¼Œé¿å…æ•°æ®æ±¡æŸ“ã€‚',
                        source: 'export-demo',
                        createTime: new Date().toISOString(),
                        difficulty: 2,
                        category: 'Vue',
                        tags: ['Vue', 'ç»„ä»¶', 'dataé€‰é¡¹']
                    }
                ];
                
                // è·å–ç°æœ‰é¢˜ç›®å¹¶æ·»åŠ æ¼”ç¤ºé¢˜ç›®
                let publicQuestions = [...this.publicQuestionBank, ...richDemoPublicQuestions];
                let personalQuestions = [...this.personalQuestionBank, ...richDemoPersonalQuestions];
                
                this.log(`ğŸ“š å¯¼å‡ºå…¬å…±é¢˜ç›®: ${publicQuestions.length} é“`);
                this.log(`ğŸ“ å¯¼å‡ºä¸ªäººé¢˜ç›®: ${personalQuestions.length} é“`);
                
                const data = {
                    deviceId: this.getDeviceId(),
                    exportTime: new Date().toISOString(),
                    syncCount: publicQuestions.length + personalQuestions.length,
                    publicQuestionCount: publicQuestions.length,
                    personalQuestionCount: personalQuestions.length,
                    publicQuestions: publicQuestions,
                    personalQuestions: personalQuestions,
                    mistakeBank: this.mistakeBank,
                    studyStats: this.studyStats,
                    deviceInfo: {
                        type: 'desktop',
                        browser: navigator.userAgent,
                        timestamp: Date.now()
                    }
                };
                
                this.log('ğŸ” å¯¼å‡ºæ•°æ®éªŒè¯:');
                this.log('   - å…¬å…±é¢˜ç›®æ•°é‡:', data.publicQuestions.length);
                this.log('   - ä¸ªäººé¢˜ç›®æ•°é‡:', data.personalQuestions.length);
                this.log('   - æ€»é¢˜ç›®æ•°é‡:', data.syncCount);
                
                const dataStr = JSON.stringify(data, null, 2);
                this.log(`ğŸ“ å¯¼å‡ºæ•°æ®å¤§å°: ${dataStr.length} å­—ç¬¦`);
                
                // æ˜¾ç¤ºç»“æœ
                const exportResult = document.getElementById('exportResult');
                exportResult.innerHTML = `
                    <h3 class="font-semibold text-gray-700 mb-2">ğŸ“¤ å¯¼å‡ºæ•°æ®ç»“æœ</h3>
                    <div class="text-sm">
                        <div class="mb-1"><span class="text-blue-600">âœ“</span> è®¾å¤‡ID: ${data.deviceId}</div>
                        <div class="mb-1"><span class="text-blue-600">âœ“</span> å¯¼å‡ºæ—¶é—´: ${new Date(data.exportTime).toLocaleString()}</div>
                        <div class="mb-1"><span class="text-blue-600">âœ“</span> å…¬å…±é¢˜ç›®: ${data.publicQuestions.length} é“</div>
                        <div class="mb-1"><span class="text-blue-600">âœ“</span> ä¸ªäººé¢˜ç›®: ${data.personalQuestions.length} é“</div>
                        <div class="mb-1"><span class="text-blue-600">âœ“</span> æ€»é¢˜ç›®æ•°: ${data.syncCount} é“</div>
                        <div class="mb-1"><span class="text-blue-600">âœ“</span> æ•°æ®å¤§å°: ${dataStr.length} å­—ç¬¦</div>
                    </div>
                `;
                
                // åˆ›å»ºä¸‹è½½é“¾æ¥
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `sync_data_${this.getDeviceId()}_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.log('âœ… åŒæ­¥æ•°æ®æ–‡ä»¶å¯¼å‡ºå®Œæˆ');
                
                return data;
            }

            // æ¨¡æ‹ŸäºŒç»´ç åŒæ­¥æ•°æ®ç”Ÿæˆæ–¹æ³•
            generateSyncQRData(syncType = 'both') {
                this.log(`ğŸ“Š å¼€å§‹ç”ŸæˆåŒæ­¥æ•°æ®ï¼Œç±»å‹: ${syncType}...`);
                
                // ç”Ÿæˆä¸°å¯Œçš„æ¼”ç¤ºé¢˜ç›®
                const richDemoPublicQuestions = [
                    {
                        id: 'rich_pub_1_' + Date.now(),
                        content: 'HTML5ä¸­ç”¨äºå®šä¹‰æ–‡æ¡£ä¸»è¦å†…å®¹çš„æ ‡ç­¾æ˜¯ï¼š',
                        type: 'single',
                        options: ['<header>', '<main>', '<section>', '<article>'],
                        answer: '1',
                        analysis: '<main>æ ‡ç­¾å®šä¹‰æ–‡æ¡£çš„ä¸»è¦å†…å®¹ï¼Œä¸€ä¸ªæ–‡æ¡£ä¸­åº”è¯¥åªæœ‰ä¸€ä¸ª<main>å…ƒç´ ã€‚',
                        source: 'rich-demo',
                        createTime: new Date().toISOString(),
                        difficulty: 2,
                        category: 'HTML5',
                        tags: ['HTML', 'è¯­ä¹‰åŒ–æ ‡ç­¾']
                    },
                    {
                        id: 'rich_pub_2_' + Date.now(),
                        content: 'CSSä¸­ï¼Œå“ªä¸ªå±æ€§ç”¨äºè®¾ç½®å…ƒç´ çš„å¤–è¾¹è·ï¼Ÿ',
                        type: 'single',
                        options: ['padding', 'border', 'margin', 'spacing'],
                        answer: '2',
                        analysis: 'marginå±æ€§ç”¨äºè®¾ç½®å…ƒç´ çš„å¤–è¾¹è·ï¼Œæ§åˆ¶å…ƒç´ ä¸å…¶ä»–å…ƒç´ ä¹‹é—´çš„è·ç¦»ã€‚',
                        source: 'rich-demo',
                        createTime: new Date().toISOString(),
                        difficulty: 1,
                        category: 'CSSåŸºç¡€',
                        tags: ['CSS', 'ç›’æ¨¡å‹']
                    }
                ];
                
                const richDemoPersonalQuestions = [
                    {
                        id: 'rich_per_1_' + Date.now(),
                        content: 'Vueç»„ä»¶çš„dataé€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚',
                        type: 'judge',
                        answer: 'true',
                        analysis: 'åœ¨Vueç»„ä»¶ä¸­ï¼Œdataé€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·æ¯ä¸ªå®ä¾‹å¯ä»¥ç»´æŠ¤ç‹¬ç«‹çš„æ•°æ®å‰¯æœ¬ï¼Œé¿å…æ•°æ®æ±¡æŸ“ã€‚',
                        source: 'rich-demo',
                        createTime: new Date().toISOString(),
                        difficulty: 2,
                        category: 'Vue',
                        tags: ['Vue', 'ç»„ä»¶', 'dataé€‰é¡¹']
                    }
                ];
                
                let publicQuestions = [];
                let personalQuestions = [];
                
                // æ ¹æ®åŒæ­¥ç±»å‹æ·»åŠ é¢˜ç›®
                if (syncType === 'both' || syncType === 'public') {
                    publicQuestions = [...this.publicQuestionBank, ...richDemoPublicQuestions];
                    this.log(`ğŸ“š åŒæ­¥å…¬å…±é¢˜ç›®: ${publicQuestions.length} é“`);
                }
                
                if (syncType === 'both' || syncType === 'personal') {
                    personalQuestions = [...this.personalQuestionBank, ...richDemoPersonalQuestions];
                    this.log(`ğŸ“ åŒæ­¥ä¸ªäººé¢˜ç›®: ${personalQuestions.length} é“`);
                }
                
                // åˆ›å»ºåŒæ­¥æ•°æ®å¯¹è±¡
                const syncData = {
                    deviceId: this.getDeviceId(),
                    timestamp: Date.now(),
                    syncType: syncType,
                    syncCount: publicQuestions.length + personalQuestions.length,
                    publicQuestionCount: publicQuestions.length,
                    personalQuestionCount: personalQuestions.length,
                    data: {
                        deviceInfo: {
                            type: 'desktop',
                            browser: navigator.userAgent,
                            timestamp: Date.now(),
                            syncType: syncType
                        },
                        // ç›´æ¥æ·»åŠ é¢˜ç›®æ•°æ®
                        publicQuestions: publicQuestions,
                        personalQuestions: personalQuestions
                    }
                };
                
                this.log('ğŸ” åŒæ­¥æ•°æ®éªŒè¯:');
                this.log('   - å…¬å…±é¢˜ç›®æ•°é‡:', syncData.data.publicQuestions ? syncData.data.publicQuestions.length : 0);
                this.log('   - ä¸ªäººé¢˜ç›®æ•°é‡:', syncData.data.personalQuestions ? syncData.data.personalQuestions.length : 0);
                this.log('   - æ€»é¢˜ç›®æ•°é‡:', syncData.syncCount);
                
                const syncDataString = JSON.stringify(syncData, null, 2);
                const encodedData = btoa(syncDataString);
                
                this.log(`ğŸ“ åŒæ­¥æ•°æ®å¤§å°: ${encodedData.length} å­—ç¬¦`);
                
                // æ˜¾ç¤ºç»“æœ
                const syncResult = document.getElementById('syncResult');
                syncResult.innerHTML = `
                    <h3 class="font-semibold text-gray-700 mb-2">ğŸ“± åŒæ­¥æ•°æ®ç»“æœ</h3>
                    <div class="text-sm">
                        <div class="mb-1"><span class="text-green-600">âœ“</span> è®¾å¤‡ID: ${syncData.deviceId}</div>
                        <div class="mb-1"><span class="text-green-600">âœ“</span> åŒæ­¥ç±»å‹: ${syncData.syncType}</div>
                        <div class="mb-1"><span class="text-green-600">âœ“</span> å…¬å…±é¢˜ç›®: ${syncData.data.publicQuestions ? syncData.data.publicQuestions.length : 0} é“</div>
                        <div class="mb-1"><span class="text-green-600">âœ“</span> ä¸ªäººé¢˜ç›®: ${syncData.data.personalQuestions ? syncData.data.personalQuestions.length : 0} é“</div>
                        <div class="mb-1"><span class="text-green-600">âœ“</span> æ€»é¢˜ç›®æ•°: ${syncData.syncCount} é“</div>
                        <div class="mb-1"><span class="text-green-600">âœ“</span> ç¼–ç åå¤§å°: ${encodedData.length} å­—ç¬¦</div>
                    </div>
                `;
                
                this.log('âœ… åŒæ­¥æ•°æ®ç”Ÿæˆå®Œæˆ');
                
                return {
                    syncData: syncData,
                    encodedData: encodedData
                };
            }

            addDemoQuestions() {
                const demoPublicQuestions = [
                    {
                        id: 'demo_pub_' + Date.now() + '_1',
                        content: 'HTMLä¸­ï¼Œå“ªä¸ªæ ‡ç­¾ç”¨äºå®šä¹‰è¡¨æ ¼ï¼Ÿ',
                        type: 'single',
                        options: ['<table>', '<tr>', '<td>', '<div>'],
                        answer: '0',
                        analysis: '<table>æ ‡ç­¾ç”¨äºå®šä¹‰HTMLè¡¨æ ¼ã€‚',
                        source: 'demo',
                        createTime: new Date().toISOString(),
                        difficulty: 1,
                        category: 'HTMLåŸºç¡€',
                        tags: ['HTML', 'è¡¨æ ¼']
                    }
                ];

                const demoPersonalQuestions = [
                    {
                        id: 'demo_per_' + Date.now() + '_1',
                        content: 'JavaScriptä¸­ï¼Œnullæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚',
                        type: 'judge',
                        answer: 'true',
                        analysis: 'åœ¨JavaScriptä¸­ï¼Œtypeof null è¿”å› "object"ï¼Œè¿™æ˜¯JavaScriptçš„ä¸€ä¸ªå†å²é—ç•™é—®é¢˜ã€‚',
                        source: 'demo',
                        createTime: new Date().toISOString(),
                        difficulty: 2,
                        category: 'JavaScript',
                        tags: ['JS', 'æ•°æ®ç±»å‹']
                    }
                ];

                this.publicQuestionBank.push(...demoPublicQuestions);
                this.personalQuestionBank.push(...demoPersonalQuestions);
                this.saveData();
                
                this.log(`âœ… æ·»åŠ äº† ${demoPublicQuestions.length} é“å…¬å…±é¢˜ç›®å’Œ ${demoPersonalQuestions.length} é“ä¸ªäººé¢˜ç›®`);
            }

            clearAllData() {
                this.publicQuestionBank = [];
                this.personalQuestionBank = [];
                this.mistakeBank = [];
                this.studyStats = { totalQuestions: 0, correctAnswers: 0, studyTime: 0 };
                localStorage.removeItem('publicQuestionBank');
                localStorage.removeItem('personalQuestionBank');
                this.log('ğŸ—‘ï¸ å·²æ¸…ç©ºæ‰€æœ‰æ•°æ®');
            }

            log(...messages) {
                const logContainer = document.getElementById('logContainer');
                const logEntry = document.createElement('div');
                const timestamp = new Date().toLocaleTimeString('zh-CN');
                logEntry.innerHTML = `<span class="text-gray-500">[${timestamp}]</span> ${messages.map(msg => 
                    typeof msg === 'object' ? JSON.stringify(msg) : msg
                ).join(' ')}`;
                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;
                
                // é™åˆ¶æ—¥å¿—æ¡ç›®æ•°é‡
                if (logContainer.children.length > 100) {
                    logContainer.removeChild(logContainer.firstChild);
                }
            }
        }

        // åˆå§‹åŒ–åº”ç”¨
        const examSystem = new MockExamSystem();

        // äº‹ä»¶ç›‘å¬å™¨
        document.getElementById('exportDataBtn').addEventListener('click', async () => {
            try {
                const exportStatus = document.getElementById('exportStatus');
                exportStatus.classList.remove('hidden');
                exportStatus.innerHTML = '<div class="text-blue-600">â³ æ­£åœ¨å¯¼å‡ºæ•°æ®...</div>';
                
                await examSystem.exportSyncData();
                
                exportStatus.innerHTML = '<div class="text-green-600">âœ… æ•°æ®å¯¼å‡ºæˆåŠŸï¼</div>';
            } catch (error) {
                examSystem.log('âŒ å¯¼å‡ºå¤±è´¥:', error.message);
                document.getElementById('exportStatus').innerHTML = `<div class="text-red-600">âŒ å¯¼å‡ºå¤±è´¥: ${error.message}</div>`;
            }
        });

        document.getElementById('generateSyncDataBtn').addEventListener('click', () => {
            try {
                const syncType = document.getElementById('syncType').value;
                const syncStatus = document.getElementById('syncStatus');
                syncStatus.classList.remove('hidden');
                syncStatus.innerHTML = '<div class="text-green-600">â³ æ­£åœ¨ç”ŸæˆåŒæ­¥æ•°æ®...</div>';
                
                const result = examSystem.generateSyncQRData(syncType);
                
                syncStatus.innerHTML = `
                    <div class="text-green-600">âœ… åŒæ­¥æ•°æ®ç”ŸæˆæˆåŠŸï¼</div>
                    <div class="mt-2 text-xs text-gray-600">
                        ç¼–ç åæ•°æ®é•¿åº¦: ${result.encodedData.length} å­—ç¬¦
                    </div>
                `;
            } catch (error) {
                examSystem.log('âŒ åŒæ­¥æ•°æ®ç”Ÿæˆå¤±è´¥:', error.message);
                document.getElementById('syncStatus').innerHTML = `<div class="text-red-600">âŒ ç”Ÿæˆå¤±è´¥: ${error.message}</div>`;
            }
        });

        document.getElementById('clearLogBtn').addEventListener('click', () => {
            document.getElementById('logContainer').innerHTML = '';
            examSystem.log('ğŸ§¹ æ—¥å¿—å·²æ¸…ç©º');
        });

        // æ·»åŠ ä¸€äº›æ¼”ç¤ºæ•°æ®
        examSystem.addDemoQuestions();
        
        // åˆå§‹åŒ–æ˜¾ç¤º
        examSystem.log('ğŸš€ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        examSystem.log('ğŸ“± è®¾å¤‡ID:', examSystem.getDeviceId());
    </script>
</body>
</html>