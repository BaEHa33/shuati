# 智能刷题系统 - 跨设备同步功能说明

## 功能概述

智能刷题系统现已支持电脑和手机之间的题库数据共享，用户可以在电脑上导入的公共题库，在手机上也能正常查看和使用。

## 支持的同步方式

### 1. 本地存储同步（基础）
- **原理**：通过浏览器的 localStorage/sessionStorage 存储用户登录信息和题库数据
- **适用场景**：同一浏览器、同一设备的不同标签页之间同步
- **限制**：不同浏览器或设备间无法直接同步

### 2. IndexedDB 存储同步（增强）
- **原理**：使用浏览器的 IndexedDB 数据库存储大量题库数据
- **适用场景**：同一设备上的大数据量题库存储和同步
- **优势**：存储空间更大（通常 50MB+），支持复杂数据结构

### 3. 扫码同步（推荐）
- **原理**：通过二维码快速建立设备间的数据连接
- **适用场景**：电脑和手机之间快速同步题库数据
- **优势**：操作简单，无需复杂配置

### 4. 文件导入导出同步
- **原理**：通过 JSON 文件导入导出题库数据
- **适用场景**：需要备份数据或在无网络环境下同步
- **优势**：支持离线使用，数据可长期保存

## 使用方法

### 方法一：扫码同步（推荐）

#### 步骤 1：在电脑端生成同步二维码
1. 在电脑浏览器中打开智能刷题系统
2. 点击右上角的用户头像，选择"设置"
3. 在设置页面中点击"📱 扫码同步"按钮
4. 系统会生成一个包含当前设备信息的二维码

#### 步骤 2：在手机端扫描二维码
1. 在手机浏览器中打开智能刷题系统
2. 确保已使用**相同的用户名**登录
3. 点击右上角的用户头像，选择"设置"
4. 点击"📱 扫码同步"按钮
5. 使用手机扫描电脑上显示的二维码

#### 步骤 3：完成同步
1. 扫描成功后，系统会自动开始同步数据
2. 同步完成后会显示成功提示
3. 刷新手机页面即可看到电脑上的公共题库

### 方法二：文件导入导出同步

#### 步骤 1：在电脑端导出同步数据
1. 在电脑浏览器中打开智能刷题系统
2. 点击右上角的用户头像，选择"设置"
3. 在设置页面中点击"📤 导出同步数据"按钮
4. 下载生成的 JSON 文件到本地

#### 步骤 2：在手机端导入同步数据
1. 将下载的 JSON 文件传输到手机上
2. 在手机浏览器中打开智能刷题系统
3. 确保已使用**相同的用户名**登录
4. 点击右上角的用户头像，选择"设置"
5. 点击"📥 导入同步数据"按钮
6. 选择传输到手机的 JSON 文件
7. 导入完成后会显示成功提示

### 方法三：自动同步（需要网络连接）

系统会在以下情况下自动尝试同步数据：
1. 用户登录成功后
2. 执行"立即同步"操作时
3. 网络连接恢复时
4. 每60秒自动检查一次同步状态

## 数据同步范围

### 自动同步的数据
- ✅ 公共题库（所有用户共享）
- ✅ 用户个人题库
- ✅ 错题本
- ✅ 学习统计数据
- ✅ 用户登录信息

### 不同步的数据
- ❌ 考试历史记录（本地保存）
- ❌ 临时设置（如当前页面状态）
- ❌ 浏览器缓存数据

## 常见问题解答

### Q1: 为什么手机看不到电脑导入的公共题库？

**可能原因及解决方案：**

1. **未使用相同用户名登录**
   - 确保电脑和手机使用完全相同的用户名登录
   - 用户名区分大小写，请仔细检查

2. **未执行同步操作**
   - 请按照"方法一：扫码同步"的步骤执行同步
   - 或使用"方法二：文件导入导出同步"

3. **浏览器存储限制**
   - 检查手机浏览器是否支持 localStorage
   - 尝试清理浏览器缓存后重新登录

4. **数据存储已满**
   - 手机端 localStorage 空间有限（通常 2-5MB）
   - 建议使用 IndexedDB 同步方式
   - 或减少题库数据量

### Q2: 同步时出现"存储空间不足"怎么办？

**解决方案：**
- 使用文件导入导出方式分批同步
- 删除不必要的题目数据
- 使用支持 IndexedDB 的现代浏览器
- 定期清理浏览器缓存

### Q3: 扫码同步失败怎么办？

**排查步骤：**
1. 检查网络连接是否正常
2. 确保二维码清晰可见
3. 尝试刷新页面重新生成二维码
4. 如果仍失败，改用文件导入导出方式

### Q4: 同步后数据不完整怎么办？

**解决方案：**
- 检查同步日志（浏览器开发者工具 Console 面板）
- 尝试重新执行同步操作
- 使用文件导入导出方式进行完整同步
- 联系技术支持获取帮助

## 技术细节说明

### 存储机制

系统采用多层存储策略：

1. **第一层：localStorage**
   - 存储用户信息和小量配置数据
   - 限制：通常 2-5MB

2. **第二层：IndexedDB**
   - 存储大量题库数据
   - 限制：通常 50MB+，取决于浏览器

3. **第三层：文件系统**
   - 通过文件导入导出实现备份
   - 无大小限制

### 同步机制

系统使用以下技术确保数据一致性：

- **增量同步**：只同步发生变化的数据
- **冲突检测**：自动检测并解决数据冲突
- **错误恢复**：同步失败时自动重试
- **数据验证**：确保同步数据的完整性

## 最佳实践

### 推荐使用方式

1. **日常使用**：扫码同步（简单快捷）
2. **大量数据**：文件导入导出（稳定可靠）
3. **定期备份**：每周导出一次同步数据作为备份
4. **多设备管理**：使用相同用户名登录所有设备

### 性能优化建议

- 定期清理不需要的题目数据
- 使用现代浏览器（Chrome、Firefox、Safari 最新版）
- 避免在同一时间进行大量数据同步
- 同步操作在 WiFi 环境下进行以获得最佳体验

## 浏览器兼容性

### 完全支持的浏览器
- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

### 部分支持的浏览器
- Chrome 50-59（部分功能受限）
- Firefox 48-54（部分功能受限）
- Safari 10-11（IndexedDB 支持有限）

### 不支持的浏览器
- IE 11 及以下版本
- Chrome 49 及以下版本
- Firefox 47 及以下版本

## 故障排除

### 同步日志查看

如需查看同步详细日志：
1. 打开浏览器开发者工具（F12 或 Ctrl+Shift+I）
2. 切换到 Console 面板
3. 查找包含 "sync"、"cross-device" 的日志信息

### 手动数据恢复

如果同步数据损坏，可以手动恢复：
1. 使用文件导入导出方式导入最近的备份
2. 或删除浏览器存储数据后重新登录

### 重置同步状态

如需重置同步状态：
1. 打开浏览器开发者工具
2. 在 Console 中执行：`localStorage.clear()`
3. 刷新页面重新登录
4. 重新执行同步操作

## 联系支持

如果遇到无法解决的同步问题，请提供以下信息联系技术支持：

1. 电脑和手机使用的浏览器版本
2. 同步操作的详细步骤
3. 浏览器 Console 中的错误日志
4. 同步数据的大致规模（题目数量）

---

**注意事项：**
- 请妥善保管同步文件，避免泄露个人学习数据
- 定期备份重要的题库数据
- 同步操作可能需要一定时间，请耐心等待
- 大型题库同步建议在 WiFi 环境下进行