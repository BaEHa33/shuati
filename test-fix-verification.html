<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒæ­¥åŠŸèƒ½ä¿®å¤éªŒè¯ - æ™ºèƒ½åˆ·é¢˜ç³»ç»Ÿ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        .btn-primary {
            background-color: #07c160;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #06ad56;
        }
        .btn-secondary {
            background-color: #f7f8fa;
            color: #333;
            border: 1px solid #e5e6eb;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-secondary:hover {
            background-color: #f2f3f5;
            border-color: #dfe1e5;
        }
        .log-entry {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: 0.25rem;
        }
        .log-success {
            background-color: #f0fdf4;
            color: #166534;
            border-left: 4px solid #22c55e;
        }
        .log-error {
            background-color: #fef2f2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }
        .log-warning {
            background-color: #fefce8;
            color: #92400e;
            border-left: 4px solid #f59e0b;
        }
        .log-info {
            background-color: #f0f9ff;
            color: #0369a1;
            border-left: 4px solid #0ea5e9;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-4">
                <i class="fa fa-check-circle text-green-500 mr-2"></i>
                åŒæ­¥åŠŸèƒ½ä¿®å¤éªŒè¯
            </h1>
            <p class="text-gray-600 mb-6">
                æ­¤é¡µé¢ç”¨äºéªŒè¯"å¯¼å‡ºåŒæ­¥æ•°æ®"æŒ‰é’®çš„ä¿®å¤æ˜¯å¦æˆåŠŸã€‚
                è¯·å…ˆç™»å½•ï¼Œç„¶åæµ‹è¯•å„ä¸ªåŒæ­¥åŠŸèƒ½æŒ‰é’®ã€‚
            </p>
            
            <!-- ç™»å½•çŠ¶æ€ -->
            <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                <h3 class="text-lg font-semibold text-blue-800 mb-2">
                    <i class="fa fa-user-circle mr-2"></i>ç™»å½•çŠ¶æ€
                </h3>
                <div id="loginStatus" class="text-gray-700">
                    <p><strong>å½“å‰ç”¨æˆ·:</strong> <span id="currentUser">æœªç™»å½•</span></p>
                    <p><strong>ç™»å½•çŠ¶æ€:</strong> <span id="loginStatusText" class="text-red-500">æœªç™»å½•</span></p>
                </div>
                <button id="loginBtn" class="btn-primary mt-3">
                    <i class="fa fa-sign-in mr-2"></i>æ¨¡æ‹Ÿç™»å½•
                </button>
                <button id="logoutBtn" class="btn-secondary mt-3 ml-3" disabled>
                    <i class="fa fa-sign-out mr-2"></i>é€€å‡ºç™»å½•
                </button>
            </div>
            
            <!-- åŒæ­¥åŠŸèƒ½æµ‹è¯• -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">
                    <i class="fa fa-sync mr-2"></i>åŒæ­¥åŠŸèƒ½æµ‹è¯•
                </h3>
                <div class="space-y-3">
                    <button id="exportBtn" class="btn-secondary w-full py-3" disabled>
                        ğŸ“¤ å¯¼å‡ºåŒæ­¥æ•°æ®
                    </button>
                    <button id="importBtn" class="btn-secondary w-full py-3" disabled>
                        ğŸ“¥ å¯¼å…¥åŒæ­¥æ•°æ®
                    </button>
                    <button id="qrcodeBtn" class="btn-secondary w-full py-3" disabled>
                        ğŸ“± æ‰«ç åŒæ­¥
                    </button>
                </div>
            </div>
            
            <!-- Vueåº”ç”¨çŠ¶æ€æ£€æµ‹ -->
            <div class="mb-6 p-4 bg-green-50 rounded-lg">
                <h3 class="text-lg font-semibold text-green-800 mb-2">
                    <i class="fa fa-code mr-2"></i>Vueåº”ç”¨çŠ¶æ€
                </h3>
                <div id="vueStatus" class="text-gray-700">
                    <p><strong>Vueåº”ç”¨å®ä¾‹:</strong> <span id="vueInstanceStatus" class="text-red-500">æœªæ£€æµ‹åˆ°</span></p>
                    <p><strong>exportSyncDataæ–¹æ³•:</strong> <span id="exportMethodStatus" class="text-red-500">æœªæ‰¾åˆ°</span></p>
                    <p><strong>crossDeviceSyncæ¨¡å—:</strong> <span id="syncModuleStatus" class="text-red-500">æœªåŠ è½½</span></p>
                </div>
                <button id="checkStatusBtn" class="btn-primary mt-3">
                    <i class="fa fa-refresh mr-2"></i>æ£€æŸ¥çŠ¶æ€
                </button>
            </div>
        </div>
        
        <!-- è°ƒè¯•æ—¥å¿— -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center">
                <i class="fa fa-terminal mr-2"></i>
                è°ƒè¯•æ—¥å¿—
                <button id="clearLogBtn" class="ml-auto btn-secondary text-sm px-3 py-1">
                    <i class="fa fa-trash mr-1"></i>æ¸…ç©º
                </button>
            </h3>
            <div id="debugLog" class="max-h-60 overflow-y-auto border border-gray-200 rounded-lg p-3 bg-gray-50">
                <div class="log-info">ğŸŸ¢ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹ç›‘æ§åŒæ­¥åŠŸèƒ½çŠ¶æ€...</div>
            </div>
        </div>
    </div>

    <script>
        // æ—¥å¿—ç³»ç»Ÿ
        class Logger {
            constructor() {
                this.logContainer = document.getElementById('debugLog');
            }
            
            log(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString('zh-CN');
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                logEntry.innerHTML = `[${timestamp}] ${message}`;
                
                this.logContainer.appendChild(logEntry);
                this.logContainer.scrollTop = this.logContainer.scrollHeight;
            }
            
            success(message) {
                this.log(`âœ… ${message}`, 'success');
            }
            
            error(message) {
                this.log(`âŒ ${message}`, 'error');
            }
            
            warning(message) {
                this.log(`âš ï¸ ${message}`, 'warning');
            }
            
            info(message) {
                this.log(`â„¹ï¸ ${message}`, 'info');
            }
            
            clear() {
                this.logContainer.innerHTML = '';
                this.info('æ—¥å¿—å·²æ¸…ç©º');
            }
        }
        
        const logger = new Logger();
        
        // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
        let mockCurrentUser = null;
        
        // æ¨¡æ‹ŸVueåº”ç”¨
        const mockApp = {
            currentUser: null,
            
            // å¯¼å‡ºåŒæ­¥æ•°æ®æ–¹æ³•
            exportSyncData() {
                logger.info('ğŸ“¤ å¼€å§‹å¯¼å‡ºåŒæ­¥æ•°æ®...');
                
                if (!this.currentUser) {
                    logger.error('ç”¨æˆ·æœªç™»å½•');
                    alert('è¯·å…ˆç™»å½•åå†å¯¼å‡ºåŒæ­¥æ•°æ®ï¼');
                    return;
                }
                
                logger.success(`ç”¨æˆ·å·²ç™»å½•: ${this.currentUser.username}`);
                
                // æ£€æŸ¥è·¨è®¾å¤‡åŒæ­¥æ¨¡å—æ˜¯å¦åŠ è½½
                if (window.crossDeviceSync) {
                    logger.success('crossDeviceSyncæ¨¡å—å·²åŠ è½½');
                    try {
                        logger.info('è°ƒç”¨exportSyncDataæ–¹æ³•...');
                        window.crossDeviceSync.exportSyncData();
                    } catch (error) {
                        logger.error(`è°ƒç”¨exportSyncDataå¤±è´¥: ${error.message}`);
                        logger.error(`é”™è¯¯è¯¦æƒ…: ${error.stack}`);
                        alert(`å¯¼å‡ºåŒæ­¥æ•°æ®å¤±è´¥ï¼\né”™è¯¯ä¿¡æ¯: ${error.message}\nè¯·æ£€æŸ¥æ§åˆ¶å°è·å–æ›´å¤šè¯¦æƒ…ã€‚`);
                    }
                } else {
                    logger.warning('crossDeviceSyncæ¨¡å—æœªåŠ è½½ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ');
                    // æ¨¡æ‹Ÿå¯¼å‡ºæˆåŠŸ
                    setTimeout(() => {
                        logger.success('âœ… åŒæ­¥æ•°æ®å¯¼å‡ºå®Œæˆï¼');
                        alert('åŒæ­¥æ•°æ®å¯¼å‡ºæˆåŠŸï¼æ–‡ä»¶å: sync_data_test.json');
                    }, 1000);
                }
            },
            
            importSyncData() {
                if (!this.currentUser) {
                    alert('è¯·å…ˆç™»å½•åå†å¯¼å…¥åŒæ­¥æ•°æ®ï¼');
                    return;
                }
                
                logger.info('ğŸ“¥ å¼€å§‹å¯¼å…¥åŒæ­¥æ•°æ®...');
                alert('é€‰æ‹©åŒæ­¥æ•°æ®æ–‡ä»¶...');
                // æ¨¡æ‹Ÿå¯¼å…¥æˆåŠŸ
                setTimeout(() => {
                    logger.success('âœ… åŒæ­¥æ•°æ®å¯¼å…¥å®Œæˆï¼');
                    alert('åŒæ­¥æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                }, 1000);
            },
            
            showSyncQRCode() {
                if (!this.currentUser) {
                    alert('è¯·å…ˆç™»å½•åå†ä½¿ç”¨æ‰«ç åŒæ­¥ï¼');
                    return;
                }
                
                logger.info('ğŸ“± æ˜¾ç¤ºæ‰«ç åŒæ­¥äºŒç»´ç ...');
                alert('æ‰«ç åŒæ­¥åŠŸèƒ½å·²å¯åŠ¨ï¼');
            }
        };
        
        // æ£€æµ‹Vueåº”ç”¨çŠ¶æ€
        function checkVueStatus() {
            logger.info('ğŸ” æ£€æŸ¥Vueåº”ç”¨çŠ¶æ€...');
            
            const vueInstanceStatus = document.getElementById('vueInstanceStatus');
            const exportMethodStatus = document.getElementById('exportMethodStatus');
            const syncModuleStatus = document.getElementById('syncModuleStatus');
            
            // æ£€æŸ¥Vueåº”ç”¨å®ä¾‹
            if (window.app) {
                vueInstanceStatus.textContent = 'å·²æ£€æµ‹åˆ°';
                vueInstanceStatus.className = 'text-green-500';
                logger.success('æ£€æµ‹åˆ°Vueåº”ç”¨å®ä¾‹');
            } else {
                vueInstanceStatus.textContent = 'æœªæ£€æµ‹åˆ°';
                vueInstanceStatus.className = 'text-red-500';
                logger.warning('æœªæ£€æµ‹åˆ°Vueåº”ç”¨å®ä¾‹ï¼Œä½¿ç”¨æ¨¡æ‹Ÿå¯¹è±¡');
            }
            
            // æ£€æŸ¥exportSyncDataæ–¹æ³•
            const app = window.app || mockApp;
            if (typeof app.exportSyncData === 'function') {
                exportMethodStatus.textContent = 'å·²æ‰¾åˆ°';
                exportMethodStatus.className = 'text-green-500';
                logger.success('æ‰¾åˆ°exportSyncDataæ–¹æ³•');
            } else {
                exportMethodStatus.textContent = 'æœªæ‰¾åˆ°';
                exportMethodStatus.className = 'text-red-500';
                logger.error('æœªæ‰¾åˆ°exportSyncDataæ–¹æ³•');
            }
            
            // æ£€æŸ¥crossDeviceSyncæ¨¡å—
            if (window.crossDeviceSync) {
                syncModuleStatus.textContent = 'å·²åŠ è½½';
                syncModuleStatus.className = 'text-green-500';
                logger.success('crossDeviceSyncæ¨¡å—å·²åŠ è½½');
            } else {
                syncModuleStatus.textContent = 'æœªåŠ è½½';
                syncModuleStatus.className = 'text-red-500';
                logger.warning('crossDeviceSyncæ¨¡å—æœªåŠ è½½');
            }
        }
        
        // æ›´æ–°ç™»å½•çŠ¶æ€
        function updateLoginStatus() {
            const currentUserSpan = document.getElementById('currentUser');
            const loginStatusText = document.getElementById('loginStatusText');
            const exportBtn = document.getElementById('exportBtn');
            const importBtn = document.getElementById('importBtn');
            const qrcodeBtn = document.getElementById('qrcodeBtn');
            const loginBtn = document.getElementById('loginBtn');
            const logoutBtn = document.getElementById('logoutBtn');
            
            if (mockCurrentUser) {
                currentUserSpan.textContent = mockCurrentUser.username;
                loginStatusText.textContent = 'å·²ç™»å½•';
                loginStatusText.className = 'text-green-500';
                
                // å¯ç”¨åŒæ­¥æŒ‰é’®
                exportBtn.disabled = false;
                importBtn.disabled = false;
                qrcodeBtn.disabled = false;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                loginBtn.disabled = true;
                logoutBtn.disabled = false;
                
                logger.success(`ç”¨æˆ· ${mockCurrentUser.username} å·²ç™»å½•`);
            } else {
                currentUserSpan.textContent = 'æœªç™»å½•';
                loginStatusText.textContent = 'æœªç™»å½•';
                loginStatusText.className = 'text-red-500';
                
                // ç¦ç”¨åŒæ­¥æŒ‰é’®
                exportBtn.disabled = true;
                importBtn.disabled = true;
                qrcodeBtn.disabled = true;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                loginBtn.disabled = false;
                logoutBtn.disabled = true;
                
                logger.info('ç”¨æˆ·æœªç™»å½•');
            }
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        document.addEventListener('DOMContentLoaded', function() {
            logger.info('é¡µé¢åˆå§‹åŒ–å®Œæˆ');
            
            // æ£€æŸ¥åˆå§‹çŠ¶æ€
            checkVueStatus();
            updateLoginStatus();
            
            // ç™»å½•æŒ‰é’®
            document.getElementById('loginBtn').addEventListener('click', function() {
                const username = prompt('è¯·è¾“å…¥ç”¨æˆ·å:', 'test_user');
                if (username && username.trim()) {
                    mockCurrentUser = {
                        id: 'user_' + username,
                        username: username.trim()
                    };
                    
                    // æ›´æ–°æ¨¡æ‹Ÿåº”ç”¨çš„ç”¨æˆ·çŠ¶æ€
                    mockApp.currentUser = mockCurrentUser;
                    
                    updateLoginStatus();
                    logger.success(`æ¨¡æ‹Ÿç™»å½•æˆåŠŸ: ${username}`);
                }
            });
            
            // é€€å‡ºç™»å½•æŒ‰é’®
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    mockCurrentUser = null;
                    mockApp.currentUser = null;
                    updateLoginStatus();
                    logger.info('ç”¨æˆ·å·²é€€å‡ºç™»å½•');
                }
            });
            
            // æ£€æŸ¥çŠ¶æ€æŒ‰é’®
            document.getElementById('checkStatusBtn').addEventListener('click', function() {
                checkVueStatus();
            });
            
            // å¯¼å‡ºåŒæ­¥æ•°æ®æŒ‰é’®
            document.getElementById('exportBtn').addEventListener('click', function() {
                const app = window.app || mockApp;
                if (typeof app.exportSyncData === 'function') {
                    try {
                        app.exportSyncData();
                    } catch (error) {
                        logger.error(`è°ƒç”¨exportSyncDataå¤±è´¥: ${error.message}`);
                        alert(`æ“ä½œå¤±è´¥: ${error.message}`);
                    }
                } else {
                    logger.error('exportSyncDataæ–¹æ³•ä¸å¯ç”¨');
                    alert('åŠŸèƒ½æš‚ä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°è·å–è¯¦æƒ…ã€‚');
                }
            });
            
            // å¯¼å…¥åŒæ­¥æ•°æ®æŒ‰é’®
            document.getElementById('importBtn').addEventListener('click', function() {
                const app = window.app || mockApp;
                if (typeof app.importSyncData === 'function') {
                    try {
                        app.importSyncData();
                    } catch (error) {
                        logger.error(`è°ƒç”¨importSyncDataå¤±è´¥: ${error.message}`);
                        alert(`æ“ä½œå¤±è´¥: ${error.message}`);
                    }
                } else {
                    logger.error('importSyncDataæ–¹æ³•ä¸å¯ç”¨');
                    alert('åŠŸèƒ½æš‚ä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°è·å–è¯¦æƒ…ã€‚');
                }
            });
            
            // æ‰«ç åŒæ­¥æŒ‰é’®
            document.getElementById('qrcodeBtn').addEventListener('click', function() {
                const app = window.app || mockApp;
                if (typeof app.showSyncQRCode === 'function') {
                    try {
                        app.showSyncQRCode();
                    } catch (error) {
                        logger.error(`è°ƒç”¨showSyncQRCodeå¤±è´¥: ${error.message}`);
                        alert(`æ“ä½œå¤±è´¥: ${error.message}`);
                    }
                } else {
                    logger.error('showSyncQRCodeæ–¹æ³•ä¸å¯ç”¨');
                    alert('åŠŸèƒ½æš‚ä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°è·å–è¯¦æƒ…ã€‚');
                }
            });
            
            // æ¸…ç©ºæ—¥å¿—æŒ‰é’®
            document.getElementById('clearLogBtn').addEventListener('click', function() {
                logger.clear();
            });
            
            // å®šæœŸæ£€æŸ¥çŠ¶æ€
            setInterval(() => {
                checkVueStatus();
            }, 5000);
            
            logger.success('æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨å·²è®¾ç½®å®Œæˆ');
        });
    </script>
</body>
</html>